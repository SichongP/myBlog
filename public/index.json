[{"authors":["admin"],"categories":null,"content":"Greetings! I\u0026rsquo;m a graduate student at UC Davis. My study focuses on completing functional annotation of the horse genome. I have a strong interest of applying genomics tools to non-model organisms to improve health care of companion and agricultral animals, as well as to enhance wildlife preservation.\n","date":-62135596800,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":-62135596800,"objectID":"598b63dd58b43bce02403646f240cd3c","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"author","summary":"Greetings! I\u0026rsquo;m a graduate student at UC Davis. My study focuses on completing functional annotation of the horse genome. I have a strong interest of applying genomics tools to non-model organisms to improve health care of companion and agricultral animals, as well as to enhance wildlife preservation.","tags":null,"title":"Sichong Peng","type":"author"},{"authors":null,"categories":null,"content":"This feature can be used for publishing content such as:\n Project or software documentation Online courses Tutorials  The parent folder may be renamed, for example, to docs for project documentation or course for creating an online course.\nTo disable this feature, either delete the parent folder, or set draft = true in the front matter of all its pages.\nAfter renaming or deleting the parent folder, you may wish to update any [[menu.main]] menu links to it in the config.toml.\n","date":1536476400,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1536476400,"objectID":"c3224f3a64174f08aaf31e1f1d16ffd3","permalink":"/tutorial/","publishdate":"2018-09-09T00:00:00-07:00","relpermalink":"/tutorial/","section":"tutorial","summary":"This feature can be used for publishing content such as:\n Project or software documentation Online courses Tutorials  The parent folder may be renamed, for example, to docs for project documentation or course for creating an online course.\nTo disable this feature, either delete the parent folder, or set draft = true in the front matter of all its pages.\nAfter renaming or deleting the parent folder, you may wish to update any [[menu.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":" Write scientific paper in markdown Introduction If you have ever written a scientific paper in MS Word (or any other word processing software) then you\u0026rsquo;re probably experienced frustrations like me: Word constantly crashing when loaded with too many high-resolution figures, citations getting messed up when working with others that use different citation managers, or hard to keep track of hundreds of versions of the draft, etc.\nOf course, Latex is always an excellent solution to all those problems. It separates content and formatting, allowing you to focus on content and leave the rest to those with expertise at it. A Tex file is also a pure text format so it\u0026rsquo;s easy to manage with a version control tool like git. However, Latex does have a rather steep learning curve. And a Tex file is not the most intuitive format to look at. For example, look at the below Tex format: Another problem with writing in Latex is, while it\u0026rsquo;s not easy to learn Latex, it\u0026rsquo;s even harder to get all your collaborators on board, which is usually the case with scientific papers.\nThat led me to think: markdown is a fantastic format that is both intuitive and powerful. Why not write in markdown? After a short search, I\u0026rsquo;m happy to report that this is indeed possible!\nWhat does writing a scientific paper require? Content aside, to write a scientific paper efficiently, one needs at least the following elements:\n Easy way to insert and manage citations. Easy way to insert and manage high resolution figures Easy way to format tables Can be converted to other formats (pdf, html, etc) Allows collaborative writing  Atom is an excellent text editor that with packages can do almost all of the above!\nRequired software and packages  Atom\n markdown-preview-enhanced zotero-citations  Pandoc\n A Tex distribution for your OS (I used Tex Live for my linux system)\n Zotero citation manager\n Bbibtex Add-on   Once you have all required packages installed, it\u0026rsquo;s time to start writing!\nWrite a paper Writing a paper in markdown is as easy as it sounds: use # for titles and subtitles, use | to format a table, among other things.\nWrite math equations You can use Latex syntax to write a math equation, like so:\n$f_A^2+2f_Af_B+f_B^2=1$  $f_A^2+2f_Af_B+f_B^2=1$\nImport figures: The way you would import a figure is a little different from the standard markdown way:\n@import \u0026quot;figure.png\u0026quot;  Would import the figure at current location. You can even further configure the figure like so:\n@import \u0026quot;figure.png\u0026quot; {width=\u0026quot;300px\u0026quot; height=\u0026quot;200px\u0026quot; title=\u0026quot;my title\u0026quot; alt=\u0026quot;my alt\u0026quot;}  Insert citations: In order to insert a citation, you need to have zotero open. With zotero open, you can call up zotero citation picker by either pressing ctrl + alt + P or pressing ctrl + shift + P to call up the command palate and search for \u0026ldquo;zotero citations: pick\u0026rdquo;. In the citation picker window like below: type in the reference you wish to insert and hit enter. A string of citation key should appear in your document:\n@bryoisEvaluationChromatinAccessibility2018  Surround this reference key with [] and you\u0026rsquo;re good to go! Once you export this document to a pdf, word, or html format, the reference will be automatically appended to the end of your document and the ref key will be replaced with corresponding references, like so: To add multiple citations, use ; to separate ref keys, like so:\n[@bintuSuperresolutionChromatinTracing2018; @bryoisEvaluationChromatinAccessibility2018]  Lastly, in order for pandoc to render citations correctly, you must provide a bib file that contains all your citations and their corresponding ref keys.\nTo do this, head on to zotero and click File -\u0026gt; Export library, in the format section, choose Better Bibtex. If you want the exported library up to date with your zotero library, check Keep updated. Once you have the exported library, add yaml frontmatter to the beginning of your document, like so:\n--- bibliography: My Library.bib ---  Export to other formats With pandoc, you can easily convert the markdown format to other text formats like pdf, word, and tex. To do this, first add output: word_document to your document\u0026rsquo;s frontmatter, like so:\n--- bibliography: My Library.bib output: word_document ---  and then you can right clock on the preview panel on the right to export the document through pandoc: This will output your document to a Word document. To output to PDF, simple change the value of output in frontmatter to pdf_document.\nConclusion Markdown is an incredibly intuitive text format and yet still versatile and powerful enough for productive writing. It has recently surged to new favorite of many among developers, scientists, and journalists. It will certainly keep raising in popularity due to its friendliness and expandability.\nWriting a scientific document in markdown has freed me of many frustrations caused by Word and with incredible pandoc, I never have to wrestle with any of my collaborators over which text editor we are to use. It has been a life saver!\n","date":1565136000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1565136000,"objectID":"940db2ad8fa86b0098f2a093182d2c4d","permalink":"/post/2019-08-07-write-scientific-paper-in-markdown/","publishdate":"2019-08-07T00:00:00Z","relpermalink":"/post/2019-08-07-write-scientific-paper-in-markdown/","section":"post","summary":"Write scientific paper in markdown Introduction If you have ever written a scientific paper in MS Word (or any other word processing software) then you\u0026rsquo;re probably experienced frustrations like me: Word constantly crashing when loaded with too many high-resolution figures, citations getting messed up when working with others that use different citation managers, or hard to keep track of hundreds of versions of the draft, etc.\nOf course, Latex is always an excellent solution to all those problems.","tags":null,"title":"Write scientific paper in markdown","type":"post"},{"authors":null,"categories":["Genetics"],"content":" Table of content  Table of content What Are Haplotype and Linkage Disequilibrium (LD) Quantify LD  Linkage Disequilibrium Coefficient ($D$): Standardized Linkage Disequilibrium Coefficient ($D\u0026rsquo;$) Correlation coefficient ($\\gamma^2$)  Now why do we care about LD and haplotype?  LD is an indication of deviation from Hardy-Weinberg equilibrium.   This is the first post of my QE prep series. I\u0026rsquo;ll be taking notes on my study for general knowledge section of my QE. I\u0026rsquo;m gonna start this off with my favorite topic in our GGG series classes: population genetics\nWhat Are Haplotype and Linkage Disequilibrium (LD) To properly understand linkage disequilibrium, I want to go back to the \u0026ldquo;Dark Age\u0026rdquo; of genetics, when Gregor Mendel brilliantly discovered (Mendelian) laws of inheritance without any knowledge of the molecular basis.\n The First Mendelian Law (Law of Segregation) states that each organism has two alleles for each trait and one of the two alleles is randomly passed on to an offspring during sexual reproduction.\n For example, an individual with an AB genotype is eqaully likely to pass an A allele or a B allele to its offspring (there are many assumption being made in this statement but I\u0026rsquo;ll roll with it for now).  The Second Mendelian Law (Law of Independent Assortment) states that alleles for different traits are passed on independantly from each other during sexual reproduction.\n For example, if allelea A/a controls for trait 1 and alleles B/b controls for trait 2 (assuming they are not at the same locus), then whether an individual passes on allele A or a is independent of wheter it passes on B or b. The Independent Assortment implicts the product rule:\n Suppose an individual with AaBb genotype (Aa at locus 1 and Bb at locus 2) mates with another individual with same AaBb genotype, the probability of their offspring being aabb is 1/16\n In case you\u0026rsquo;re wondering how to get this number, here is my favorite way to calculate:\n   In the above diagram, first step involves the Law of Segregation, by which I calculated the probability of each gamete containing each allele separately. The second step is where the Law of Independent Assortment comes into play: The probability of each combination of two alleles is the product of the probabilities of each allele (in one gamete). And the last step is just random combination of two gametes (for a diploid organism).\nHowever, just as every law has an exception, it was discovered that many of traits in various species didn\u0026rsquo;t really follow the Law of Independent Assortment. The following example shows a case of \u0026ldquo;dependent assortment\u0026rdquo;:\n Sweet peas have purple (P) or red (p) flowers and long (L) or short (l) pollen grains. Peas from two pure lines (PPLL and ppll) were crossed. The offspring (F1) are all purple flower and long grain (PpLl). They are then self crossed (PpLl X PpLl).\nAssuming indenpendent assortment, we expect to observe all 4 phenotypes in F2 with the following frequencies:\n    Phenotype Frequency     Purple (P), Long (L) 9\u0026frasl;16   Purple (P_), Short (ll) 3\u0026frasl;16   Red (pp), Long (L_) 3\u0026frasl;16   Red (pp), Short (ll) 1\u0026frasl;16     However, large deviations from expected phenotype frequency were observed:\n    Phenotype Exp. Count Obs. Count     Purple, Long (P_L_) 216 284   Purple, Short (P_ll) 72 21   Red, Long (ppL_) 72 21   Red, Short (ppll) 24 55    Data from Bateson et al.\nWe know that in the parent line (PPLL x ppll) P and L as well as p and l are always together because they are both homozygotes. But as the Mendel\u0026rsquo;s second law predicts, they should\u0026rsquo;ve independently assorted from F1 to F2. We, however, see that instead of random combination, P still appear more often together with L and so does p and l. It\u0026rsquo;s as if P and L were somehow linked. This phenomenon is termed Linkage. We now know that this is because the two loci are closeby on the same chromsome and that during meiosis, DNA on one chromsome are largely segregated together (except some recombination).\nWhen two loci are linked, product rule no longer applies. This causes a non-random association of alleles at different loci in a given population. This is termed Linkage Disequilibrium or LD. (Technically LD does not always mean physical linkage. More on this later.)\nWhen we talk about linkage, knowing genotype of an individual alone is no longer enough: we wish to know which alleles are \u0026ldquo;linked\u0026rdquo; or belong to the same chromsome. In genetics, we call alleles that are on the same chromsome and likely to be inherited together a haplotype. For example, an individual with a PpLl genotype may have these different haplotypes:\n PL and pl Pl and pL  Quantify LD There are several different ways to quntify the extent of linkage between any two loci:\n Coefficient of Linkage Disequilibrium (D) Normalized coefficient of Linkage Disequilibrium (D\u0026rsquo;) Correlation coefficient ($r^2$) and $\\chi^2$ test  I\u0026rsquo;ll briefly go over them below.\nLinkage Disequilibrium Coefficient ($D$): As mentioned before, if two loci are independent, their frequencies follow product rule:\nFor two independent loci A and B, each with two alleles ($A_1$, $A_2$ and $B_1$, $B_2$, respectively), we have: $$f_{A_1B_1} = f_{A_1}f_{B_1}$$ Now if A and B are not independent, this equation no longer stands true. In that case we have: $$f_{A_1B_1} = f_{A_1}f_{B_1} + D$$ Here we have D as a measurement of the extent of linkage disequilibrium between $A_1$ and $B_1$. We can calculate the same for all 4 haplotypes:\n    A $A_1$ $A_2$     B frequency $f_{A_1}$ $f_{A_2}$   $B_1$ $f_{B_1}$ $f_{A_1}f_{B_1} + D_{A_1B_1}$ $f_{A_2}f_{B_1} + D_{A_2B_1}$   $B_2$ $f_{B_2}$ $f_{A_1}f_{B_2} + D_{A_1B_2}$ $f_{A_2}f_{B_2} + D_{A_2B_2}$    Solve above equations and we get:\n $D_{A_1B_1} = f_{A_1B_1} - f_{A_1}f_{B_1}$\n$D_{A_1B_2} = f_{A_1B_2} - f_{A_1}f_{B_2}$\n$D_{A_2B_1} = f_{A_2B_1} - f_{A_2}f_{B_1}$\n$D_{A_2B_2} = f_{A_2B_2} - f_{A_2}f_{B_2}$\n For a given population, we have\n $f_{A_1} + f_{A_2} = 1$\n$f_{B_1} + f_{B_2} = 1$\n$f_{A_1B_1} + f_{A_1B_2} = f_{A_1}$\n$f_{A_1B_1} + f_{A_2B_1} = f_{B_1}$\n$f_{A_2B_1} + f_{A_2B_2} = f_{A_2} = 1 - f_{A_1}$\n$f_{A_1B_2} + f_{A_2B_2} = f_{B_2} = 1 - f_{B_1}$\n We can then further derive above equations:\n $D_{A_2B_2} \\\\\\ = f_{A_2B_2} - (1 - f_{A_1})(1 - f_{B_1}) \\\\\\\\ = 1 - f_{B_1} - f_{A_1B_2} - (1 - f_{A_1})(1 - f_{B_1}) \\\\\\ = 1 - f_{B_1} - f_{A_1} - f_{A_1B_1} - (1 - f_{A_1})(1 - f_{B_1}) \\\\\\ = 1 - f_{B_1} - f_{A_1} + f_{A_1B_1} - 1 + f_{B_1} + f_{A_1} - f_{A_1}f_{B_1} \\\\\\ = f_{A_1B_1} - f_{A_1}f_{B_1} = D_{A_1B_1}$\n Similarly we can prove that $D_{A_1B_1} = - D_{A_1B_2} = - D_{A_2B_1} = D_{A_2B_2} = D$ (note that this is only true for diallelic loci. For loci with more than two alleles, we need to calculate D for each allele pair separately.)\nThis makes sense because linkage disequilibrium should be a measurement of two loci not any two specific alleles in those loci. Therefore the D for any haplotype between the two given loci should be the same (or at least the absolute value of it). We then have:\n $D = D_{A_1B_1} = f_{A_1B_1} - f_{A_1}f_{B_1}$\n$D = -D_{A_1B_2} = -f_{A_1B_2} + f_{A_1}f_{B_2}$\n$D = -D_{A_2B_1} = -f_{A_2B_1} + f_{A_2}f_{B_1}$\n$D = D_{A_2B_2} = f_{A_2B_2} - f_{A_2}f_{B_2}$\n Next we can prove that $D = f_{A_1B_1}f_{A_2B_2} - f_{A_1B_2}f_{A_2B_1}$:\n $f_{A_1B_1}f_{A_2B_2} \\\\\\ = (f_{A_1}f_{B_1} + D)(f_{A_2}f_{B_2} + D) \\\\\\ = f_{A_1}f_{A_2}f_{B_1}f_{B_2} + D(f_{A_1}f_{B_1} + f_{A_2}f_{B_2}) + D^2$\n$f_{A_1B_2}f_{A_2B_1} \\\\\\ = (f_{A_1}f_{B_2} - D)(f_{A_2}f_{B_1} - D) \\\\\\ = f_{A_1}f_{A_2}f_{B_1}f_{B_2} - D(f_{A_1}f_{B_2} + f_{A_2}f_{B_1}) + D^2$\n Taske substraction:\n $f_{A_1B_1}f_{A_2B_2} - f_{A_1B_2}f_{A_2B_1} \\\\\\ = f_{A_1}f_{A_2}f_{B_1}f_{B_2} + D(f_{A_1}f_{B_1} + f_{A_2}f_{B_2}) + D^2 - (f_{A_1}f_{A_2}f_{B_1}f_{B_2} - D(f_{A_1}f_{B_2} + f_{A_2}f_{B_1}) + D^2) \\\\\\ = D(f_{A_1}f_{B_1} + f_{A_2}f_{B_2} + f_{A_1}f_{B_2} + f_{A_2}f_{B_1}) = D * 1 = D$\n Now we have a measure of linkage disequilibrium. By definition, we know that $D=0$ indicates independent loci (no linkage). What should the maxium value of D be?\n Say we have a population with following genotype frequency: $f_{A_1} = f_{A_2} = 0.5 \\\\\\ f_{B_1} = f_{B_2} = 0.5$\nSuppose there is complete linkage between $A_1$ and $B_1$, meaning we have following haplotype frequencies: $f_{A_1B_1} = f_{A_2B_2} = 0.5 \\\\\\ f_{A_1B_2} = f_{A_2B_1} = 0$\nWe can then calculate $D = f_{A_1B_1}f_{A_2B_2} - f_{A_1B_2}f_{A_2B_1} = 0.5 * 0.5 - 0 = 0.25$\n When two loci are in complete linkage, we have $D=0.25$. For any two loci, we always have $D \\in [-0.25,0.25]$.\nThis scale is not very intuitive but we can work with it. Now next question is, does equal $D$ mean equal linkage disequilibrium?\n Consider the following two populations:\n Pop 1 has haplotype frequencies as follow: $$f_{A_1B_1} = f_{A_2B_2} = 0.34 \\\\\\ f_{A_1B_2} = f_{A_2B_1} = 0.16$$ We can calculate $D = 0.34^2 - 0.16^2 = 0.09$ Pop 2 has haplotype frequencies as follow: $$f_{A_1B_1} = 0.9 \\\\\\ f_{A_2B_2} = 0.1 \\\\\\ f_{A_1B_2} = f_{A_2B_1} = 0$$ We can calculate $D = 0.9 * 0.1 - 0 = 0.09$   Even though $D$ at these loci for both populations is exactly the same, we can clearly see that pop 2 has comlete linkage between these two loci while pop 1 does not.\nThis example shows a major problem of $D$ for measuring linkage disequilibrium: It\u0026rsquo;s ignorant of allele frequencies in a given population.\nStandardized Linkage Disequilibrium Coefficient ($D\u0026rsquo;$) To address this problem, we can standardize $D$ against allele frequency: $$D\u0026rsquo; = \\frac{D}{D_{max}}$$\n$D_{max}$ is the maxium possible $D$ in a population with same allele frequencies (but different haplotype frequencies). We have $$D_{max} = f_{maxA_1B_1} - f_{A_1}f_{B_1} \\\\\\ = min(f_{A_1},f_{B_1}) - f_{A_1}f_{B_1}$$ We can also prove that for every haplotype between two given loci, we can get the same $D\u0026rsquo;$.\nFor example, in the above two populations:\n  Pop 1: $$f_{A_1} = f_{A_2} = f_{B_1} = f_{B_2} = 0.5 \\\\\\ D_{max} = 0.5 - 0.5 * 0.5 = 0.25 \\\\\\ D\u0026rsquo; = \\frac{D}{D_{max}} = \\frac{0.09}{0.25} = \\frac{9}{25} $$ Pop 2: $$f_{A_1} = f_{B_1} = 0.9 \\\\\\ f_{A_2} = f_{B_2} = 0.1 \\\\\\ D_{max} = 0.9 - 0.9 * 0.9 = 0.09 \\\\\\ D\u0026rsquo; = \\frac{D}{D_{max}} = \\frac{0.09}{0.09} = 1$$   Now we can see that $D\u0026rsquo;$ for population 2 is much higher than that of population 1, indicating a much higher linkage disequilibrium between these loci in pop 2. By definition, we know $D\u0026rsquo; \\in [0,1]$\nHowever, $D\u0026rsquo;$ also has its own problem. Consider the following scenario:\n Suppose we genotyped 100 individuals in a population, and count occurrance of each haplotype between loci A and B as follow:\n     Count Total     $A_1B_1$ 50 100   $A_1B_2$ 49 100   $A_2B_1$ 0 100   $A_2B_2$ 1 100     We can get haplotype and allele frequencies: $$f_{A_1B_1} = 0.5, f_{A_1B_2} = 0.49 \\\\\\ f_{A_2B_1} = 0, f_{A_2B_2} = 0.01 \\\\\\ f_{A_1} = 0.99, f_{A_2} = 0.01 \\\\\\ f_{B_1} = 0.5, f_{B_2} = 0.5$$ And calculate $D\u0026rsquo;$: $$D\u0026rsquo; = \\frac{f_{A_1B_1} * f_{A_2B_2} - f_{A_1B_2} * f_{A_2B_1}}{min(f_{A_1}, f_{B_1}) - f_{A_1}f_{B_1}} = \\frac{0.5 * 0.01 - 0.49 * 0}{0.5 - 0.5 * 0.99} = 1$$\n In this case, $D\u0026rsquo;$ indicates strong linkage between the two loci. However, looking at data, we can\u0026rsquo;t confidently make any conclusions regarding the linkage between the two loci. The reason is that in all samples but one, they have either $A_1B_1$ or $A_1B_2$ haplotype. The only one that has an $A_2$ allele can simply be a result of a spontaneous mutaion rather than inheriting from a parent We do not have enough information to say whether or not A locus is linked with B locus because $A_2$ is mostly missing from data.\nIn other words, $D\u0026rsquo;$ does not tell us how significant a linkage is or how confident we are in decalring a linkage disequilibrium. For this purpose, we turn to Pearson\u0026rsquo;s correlation coefficient.\nCorrelation coefficient ($\\gamma^2$) Consider the population above:\n    Count Total     $A_1B_1$ 50 100   $A_1B_2$ 49 100   $A_2B_1$ 0 100   $A_2B_2$ 1 100    We calculated that $D=0.005$, now instead of standardizing it like what we did with $D\u0026rsquo;$, we try a different approach: $$\\gamma^2 = \\frac{D^2}{f_{A_1}f_{A_2}f_{B_1}f_{B_2}}$$\nWe have $\\gamma^2 = \\frac{0.005^2}{0.99 * 0.01 * 0.5 * 0.5} = 0.01$\nNow this seems to align well with our assessment of the data! As a matter of fact, this is actually the correlation coefficient of the two variables in this population!\nLet\u0026rsquo;s arbitratrily assign 1 to an $A_1$ allele and -1 to an $A_2$ allele. And 1 to $B_1$, -1 to $B_2$. Now we can plot the data and calculate $\\gamma$:\n Correlation plot   In the above plot we have $R=0.1$ this is exactly what we calculated above ($\\gamma^2 = 0.01$)! Now that we have a correlation coefficient, we can use a $\\chi^2$ test on our dataset:\n$$\\chi_S^2=\\gamma^2*N=0.01*100=1\\\\\\ P(\\chi^2\u0026gt;\\chi_S^2, df=1) = 0.317 $$\nThe p-value is also shown in the above plot. Clearly, we don\u0026rsquo;t see a significant correlation (i.e linkage) between the two loci.\nThis is the beauty of $\\gamma^2$: it not only tells us the strength of a linkage ($\\gamma^2$) but only indicates confidence in such linkage given data ($\\chi^2$)!\nNow remember, the absence of significance is NOT evidence of insignificance! Look at the above figure and we notice that the confidence interval of the plot is very large towards $x=-1$. This is because we have only a single data point at $x=-1$. This could easily be a sampling error or like mentioned above, a spontaneous mutation. It is possible, that there are more individuals with $A_2$ allele but we just didn\u0026rsquo;t include them in our samples for unknown reasons. In this case, since we can\u0026rsquo;t estimate frequencies of $A_2$ in haplotype $A_2B_1$ or $A_2B_2$, we can\u0026rsquo;t conclude with any confidence whether or not there is linkage between the two loci.\nNow why do we care about LD and haplotype? LD is an indication of deviation from Hardy-Weinberg equilibrium. ","date":1553126400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1553126400,"objectID":"e526bcca6bd9373e71592039ef7c2786","permalink":"/post/haplotype-ld-and-association-tests/","publishdate":"2019-03-21T00:00:00Z","relpermalink":"/post/haplotype-ld-and-association-tests/","section":"post","summary":"Table of content  Table of content What Are Haplotype and Linkage Disequilibrium (LD) Quantify LD  Linkage Disequilibrium Coefficient ($D$): Standardized Linkage Disequilibrium Coefficient ($D\u0026rsquo;$) Correlation coefficient ($\\gamma^2$)  Now why do we care about LD and haplotype?  LD is an indication of deviation from Hardy-Weinberg equilibrium.   This is the first post of my QE prep series. I\u0026rsquo;ll be taking notes on my study for general knowledge section of my QE.","tags":["Population Genetics","QE","Statistics"],"title":"Haplotype, LD, and Association Tests","type":"post"},{"authors":null,"categories":["Python"],"content":"I want to split sequences in a fasta file at Ns.\nHere is what an example file looks like:\n\u0026gt;1_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGT ACACACGTAGCAGCATCAGCATNNNNNNNNNNNNNNNNNNNNGTTGGACGG NNNNNNNNNNNNGGTGACACACGAGATATATFAGATCAACGTAAGGGATGA NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCGNNNN \u0026gt;2_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGT ACACACGTAGCAGCATCAGCATATTCGATGGCATCGATACCGGTTGGACGG NNNNNNNNNNNNGGTGACACACGAGATATATFAGATCAACGTAAGGGATGA NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCGNNNN  There are two common formats for FASTA files:\n- Single line FASTA\nEach record consists of two line: a name line (starts with \u0026ldquo;\u0026gt;\u0026rdquo;) and a sequence line. - Multiline FASTA\nEach records consists of multiple lines, First line is a name line (starts with \u0026ldquo;\u0026gt;\u0026rdquo;), followed by multiple lines of sequences.\nHere I assume I\u0026rsquo;m dealing with multiline FASTA because if a script can work with multiline fasta, it\u0026rsquo;s generally easy to make it work with single line files.\nHere is how I approach it:\nimport sys with open('test','r') as f: seq = [] for line in f: if line.startswith(\u0026quot;\u0026gt;\u0026quot;): if seq: #seq not empty, process it trim = '\\n'.join(''.join(seq).replace(\u0026quot;N\u0026quot;,\u0026quot; \u0026quot;).split()) print(trim) seq = [] print(line.strip()) else: #Read lines into a single seq seq.append(line.strip()) if seq: #seq not empty, process it trim = '\\n'.join(''.join(seq).replace(\u0026quot;N\u0026quot;,\u0026quot; \u0026quot;).split()) print(trim) seq = []  \u0026gt;1_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGTACACACGTAGCAGCATCAGCAT GTTGGACGG GGTGACACACGAGATATATFAGATCAACGTAAGGGATGA AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCG \u0026gt;2_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGTACACACGTAGCAGCATCAGCATATTCGATGGCATCGATACCGGTTGGACGG GGTGACACACGAGATATATFAGATCAACGTAAGGGATGA AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCG  ","date":1553040000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1553040000,"objectID":"c77329396a33f989b5c5b6bcf4f1c6a8","permalink":"/post/split-a-fasta-record-by-ns/","publishdate":"2019-03-20T00:00:00Z","relpermalink":"/post/split-a-fasta-record-by-ns/","section":"post","summary":"I want to split sequences in a fasta file at Ns.\nHere is what an example file looks like:\n\u0026gt;1_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGT ACACACGTAGCAGCATCAGCATNNNNNNNNNNNNNNNNNNNNGTTGGACGG NNNNNNNNNNNNGGTGACACACGAGATATATFAGATCAACGTAAGGGATGA NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCGNNNN \u0026gt;2_name ACGTTGCGGCATTCGATCGACGATCGATGCAAACGGTCACGGACTGACTGT ACACACGTAGCAGCATCAGCATATTCGATGGCATCGATACCGGTTGGACGG NNNNNNNNNNNNGGTGACACACGAGATATATFAGATCAACGTAAGGGATGA NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN AGTCGCTAGCATGCATGGCATATACGCGATCGATTCGATAGCTAGCGNNNN  There are two common formats for FASTA files:\n- Single line FASTA\nEach record consists of two line: a name line (starts with \u0026ldquo;\u0026gt;\u0026rdquo;) and a sequence line. - Multiline FASTA\nEach records consists of multiple lines, First line is a name line (starts with \u0026ldquo;\u0026gt;\u0026rdquo;), followed by multiple lines of sequences.","tags":["Python","bioinformatics","FASTA"],"title":"Split a FASTA record by Ns","type":"post"},{"authors":null,"categories":["R"],"content":" Recently Someone asked a question on reddit: Adding a row and a column that are means for a set matrix\nThis is a very simple problem that many of us learned how to do only a few hours in to basic R. But since I’ve been learning tidyverse package, I figured why not do it tidy-fashion?\nLet’s give it a try.\nHere is the question:\n I have the following sequence:\nS\u0026lt;-seq(1,90, by=3)\nI make a matrix that is the following:\nmatrix(S, nrow = 6, ncol = 5)\nNow I am trying to do the following:\nI want to calculate the means of the columns of the matrix and add them as a new row under the columns.\nNext I want to calculate the sum of the rows of the matrix and add them as a new column on the right of the matrix.\n Here is what their data looks like:\ndata_matrix = matrix(seq(1, 90, by = 3), nrow = 6, ncol = 5) data_matrix ## [,1] [,2] [,3] [,4] [,5] ## [1,] 1 19 37 55 73 ## [2,] 4 22 40 58 76 ## [3,] 7 25 43 61 79 ## [4,] 10 28 46 64 82 ## [5,] 13 31 49 67 85 ## [6,] 16 34 52 70 88 They want to calculate the mean of each column and sum of each row.\nNow if you know some basic R this can very easily be achieved:\ndata_df = data.frame(data_matrix) data_df[,ncol(data_df)+1] = rowSums(data_df) data_df[nrow(data_df)+1,] = colMeans(data_df) head(data_df) ## X1 X2 X3 X4 X5 V6 ## 1 1 19 37 55 73 185 ## 2 4 22 40 58 76 200 ## 3 7 25 43 61 79 215 ## 4 10 28 46 64 82 230 ## 5 13 31 49 67 85 245 ## 6 16 34 52 70 88 260 But how can we do this “tidy” way? Turns out this is more complicated than I originally thought.\nFirst let’s breath some context into our data so we don’t get too bored:\nLet’s say we had an exam in a class of 50 students. The exam consists of 5 questions. TAs recorded the score of each question for each student on an excel sheet. The spreadsheet data has 5 columns, each for a question and 50 rows, each for a student. Now we want to calculate:\n1. Total score for each student (row sums)\n2. Class average for each question (col means)\nLet’s first creat this “spreadsheet”\nscores_df = data.frame(matrix(sample(1:20,250, replace = TRUE), nrow = 50, ncol = 5)) head(scores_df) ## X1 X2 X3 X4 X5 ## 1 19 13 7 9 16 ## 2 5 11 12 14 19 ## 3 5 11 6 8 20 ## 4 8 9 8 9 6 ## 5 3 14 4 7 6 ## 6 8 12 6 15 15 Here we have a data frame with 5 colmuns (5 questions) and 50 rows (50 students).\nNow the next step is to for tidy data: key-value pairs.\nFirst we need to identify the keys: in our dataset, each student-question pair uniquely identifies a value (score). So we can gather our date like this:\nlibrary(tidyverse) scores_tibble = gather(rownames_to_column(scores_df, var = \u0026quot;student\u0026quot;), question, score, -student) head(scores_tibble) ## student question score ## 1 1 X1 19 ## 2 2 X1 5 ## 3 3 X1 5 ## 4 4 X1 8 ## 5 5 X1 3 ## 6 6 X1 8 Here I did not unite() student and question into a single column so that later I can group by either student or question to calculate mean and sum.\nNow to calculate question means:\nsummarise(group_by(scores_tibble, question), mean = mean(score)) ## # A tibble: 5 x 2 ## question mean ## \u0026lt;chr\u0026gt; \u0026lt;dbl\u0026gt; ## 1 X1 11 ## 2 X2 11.1 ## 3 X3 9.7 ## 4 X4 9.78 ## 5 X5 10.8 Student sum scores:\nsummarise(group_by(scores_tibble, student), total = sum(score)) ## # A tibble: 50 x 2 ## student total ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 1 64 ## 2 10 46 ## 3 11 78 ## 4 12 63 ## 5 13 50 ## 6 14 56 ## 7 15 44 ## 8 16 40 ## 9 17 64 ## 10 18 43 ## # … with 40 more rows Let’s get a single table with all information\nscores_complete = group_by(scores_tibble, question) %\u0026gt;% mutate(question_average = mean(score)) %\u0026gt;% group_by(student) %\u0026gt;% mutate(student_total = sum(score)) scores_complete ## # A tibble: 250 x 5 ## # Groups: student [50] ## student question score question_average student_total ## \u0026lt;chr\u0026gt; \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt; \u0026lt;int\u0026gt; ## 1 1 X1 19 11 64 ## 2 2 X1 5 11 61 ## 3 3 X1 5 11 50 ## 4 4 X1 8 11 40 ## 5 5 X1 3 11 34 ## 6 6 X1 8 11 56 ## 7 7 X1 2 11 53 ## 8 8 X1 1 11 42 ## 9 9 X1 17 11 63 ## 10 10 X1 8 11 46 ## # … with 240 more rows With a tidy table we can easily calculate stats we want and add them to the original data frame:\nscores_df_complete = spread(scores_tibble, question, score) %\u0026gt;% left_join(summarise(group_by(scores_tibble, student), student_total = sum(score)), by = \u0026quot;student\u0026quot;) %\u0026gt;% bind_rows(spread(summarise(group_by(scores_tibble, question), question_mean = mean(score)), question, question_mean)) head(scores_df_complete) ## student X1 X2 X3 X4 X5 student_total ## 1 1 19 13 7 9 16 64 ## 2 10 8 20 4 1 13 46 ## 3 11 15 19 10 18 16 78 ## 4 12 6 14 13 20 10 63 ## 5 13 3 6 13 19 9 50 ## 6 14 10 19 10 15 2 56 tail(scores_df_complete) ## student X1 X2 X3 X4 X5 student_total ## 46 50 12 20.00 17.0 19.00 1.00 69 ## 47 6 8 12.00 6.0 15.00 15.00 56 ## 48 7 2 9.00 18.0 15.00 9.00 53 ## 49 8 1 16.00 11.0 3.00 11.00 42 ## 50 9 17 8.00 9.0 11.00 18.00 63 ## 51 \u0026lt;NA\u0026gt; 11 11.08 9.7 9.78 10.84 NA ","date":1552262400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1552262400,"objectID":"9eaccf4c94c58e468784c9a82d2be8be","permalink":"/post/calculate-row-sums-and-col-means-with-tidyr/","publishdate":"2019-03-11T00:00:00Z","relpermalink":"/post/calculate-row-sums-and-col-means-with-tidyr/","section":"post","summary":"Recently Someone asked a question on reddit: Adding a row and a column that are means for a set matrix\nThis is a very simple problem that many of us learned how to do only a few hours in to basic R. But since I’ve been learning tidyverse package, I figured why not do it tidy-fashion?\nLet’s give it a try.\nHere is the question:\n I have the following sequence:","tags":["tidyverse","R"],"title":"Calculate row sums and col means with tidyR","type":"post"},{"authors":null,"categories":null,"content":" In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 \u0026hellip;\nTip 2 \u0026hellip;\n","date":1536476400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1536476400,"objectID":"6a451186c775f5f0adb3a0416d0cb711","permalink":"/tutorial/example/","publishdate":"2018-09-09T00:00:00-07:00","relpermalink":"/tutorial/example/","section":"tutorial","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 \u0026hellip;\nTip 2 \u0026hellip;","tags":null,"title":"Example Page","type":"docs"},{"authors":[],"categories":null,"content":" Click on the **Slides** button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Academic\u0026rsquo;s Slides feature and link using url_slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further talk details can easily be added to this page using Markdown and $\\rm \\LaTeX$ math code.\n","date":1483257600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1483257600,"objectID":"96344c08df50a1b693cc40432115cbe3","permalink":"/talk/example/","publishdate":"2017-01-01T00:00:00-08:00","relpermalink":"/talk/example/","section":"talk","summary":"An example talk using Academic's Markdown slides feature.","tags":[],"title":"Example Talk","type":"talk"},{"authors":null,"categories":null,"content":"","date":1461740400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461740400,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00-07:00","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461740400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461740400,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00-07:00","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":null,"categories":null,"content":" Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = \\;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\nFragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \nA fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears  Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view   Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links   night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links  Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"c2915ec5da95791851caafdcba9664af","permalink":"/slides/example-slides/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/slides/example-slides/","section":"slides","summary":"Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$","tags":null,"title":"Slides","type":"slides"}]